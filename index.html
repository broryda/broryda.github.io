<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Baduk Study Hub</title>
  <meta name="description" content="바둑 공부 링크, 일정, 자료를 한 곳에서 관리하는 개인 허브" />
  <meta name="color-scheme" content="light dark" />
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='45' fill='%23000'/><circle cx='38' cy='42' r='9' fill='%23fff'/></svg>">
  <!-- Tailwind (CDN) -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: { sans: ["Inter", "ui-sans-serif", "system-ui", "Apple SD Gothic Neo", "Noto Sans KR", "Segoe UI", "Helvetica", "Arial", "Apple Color Emoji", "Segoe UI Emoji"] },
          colors: { brand: { 50: '#eef7ff', 100:'#daedff', 200:'#b6dbff', 300:'#88c4ff', 400:'#5aaaff', 500:'#378eff', 600:'#1f73f7', 700:'#165bd1', 800:'#154aa8', 900:'#163f85' } }
        }
      }
    }
  </script>
  <style>
    :root { --card-bg: rgba(255,255,255,.7); --glass: blur(10px); }
    @media (prefers-color-scheme: dark) {
      :root { --card-bg: rgba(17,24,39,.6); }
    }
  </style>
</head>
<body class="min-h-screen bg-gradient-to-b from-brand-50 to-white dark:from-slate-900 dark:to-slate-950 text-slate-800 dark:text-slate-100">
  <header class="sticky top-0 z-30 backdrop-blur supports-[backdrop-filter]:bg-white/60 dark:supports-[backdrop-filter]:bg-slate-900/60 border-b border-slate-200/60 dark:border-slate-800">
    <div class="mx-auto max-w-6xl px-4 py-3 flex items-center justify-between">
      <a href="#" class="flex items-center gap-3">
        <span class="inline-grid place-items-center w-9 h-9 rounded-full bg-slate-900 text-white dark:bg-white dark:text-slate-900 shadow">
          ●
        </span>
        <div>
          <h1 class="text-lg font-bold leading-tight">Baduk Study Hub</h1>
          <p class="text-xs text-slate-500 dark:text-slate-400">링크 · 일정 · 자료</p>
        </div>
      </a>
      <nav class="hidden sm:flex gap-2" aria-label="주 메뉴">
        <button data-tab="links" class="tab-btn px-3 py-1.5 rounded-lg text-sm font-medium bg-slate-900 text-white dark:bg-white dark:text-slate-900">링크</button>
        <button data-tab="schedule" class="tab-btn px-3 py-1.5 rounded-lg text-sm font-medium hover:bg-slate-200/60 dark:hover:bg-slate-800/60">일정</button>
        <button data-tab="notes" class="tab-btn px-3 py-1.5 rounded-lg text-sm font-medium hover:bg-slate-200/60 dark:hover:bg-slate-800/60">노트</button>
        <button data-tab="about" class="tab-btn px-3 py-1.5 rounded-lg text-sm font-medium hover:bg-slate-200/60 dark:hover:bg-slate-800/60">소개</button>
      </nav>
      <div class="flex items-center gap-2">
        <button id="addLinkBtn" class="px-3 py-1.5 rounded-lg text-sm font-medium border border-slate-300/60 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-800">링크 추가</button>
        <a class="px-3 py-1.5 rounded-lg text-sm font-medium bg-brand-600 text-white hover:bg-brand-700" href="#" id="editBtn">빠른 편집</a>
      </div>
    </div>
  </header>

  <main class="mx-auto max-w-6xl px-4 py-8">
    <!-- Links Tab -->
    <section id="tab-links" class="tab-pane grid gap-6">
      <div class="grid md:grid-cols-3 gap-6">
        <!-- Card: Study Links -->
        <article class="rounded-2xl shadow-sm border border-slate-200/60 dark:border-slate-800 bg-[var(--card-bg)] backdrop-blur-md p-5">
          <header class="flex items-center justify-between mb-3">
            <h2 class="font-semibold">공부 링크</h2>
            <span class="text-xs text-slate-500" id="linksCount">0개</span>
          </header>
          <ul id="linksList" class="grid gap-2">
            <!-- JS 렌더링 -->
          </ul>
          <p class="mt-3 text-xs text-slate-500">Tip: 상단의 <b>링크 추가</b> 버튼으로 항목을 언제든지 추가할 수 있습니다. (브라우저에 로컬 저장)</p>
        </article>

        <!-- Card: Channels -->
        <article class="rounded-2xl shadow-sm border border-slate-200/60 dark:border-slate-800 bg-[var(--card-bg)] backdrop-blur-md p-5">
          <header class="mb-3"><h2 class="font-semibold">자주 쓰는 채널</h2></header>
          <ul class="grid gap-2" id="channelsList">
            <li><a class="row" href="https://online-go.com/" target="_blank" rel="noopener">OGS (Online-Go)</a></li>
            <li><a class="row" href="https://www.101weiqi.com/" target="_blank" rel="noopener">101围棋网</a></li>
            <li><a class="row" href="https://badukpop.com/" target="_blank" rel="noopener">BadukPop</a></li>
            <li><a class="row" href="https://senseis.xmp.net/" target="_blank" rel="noopener">Sensei's Library</a></li>
            <li><a class="row" href="https://www.youtube.com/results?search_query=%EB%B0%94%EB%91%91+%EA%B0%95%EC%9D%98" target="_blank" rel="noopener">YouTube 바둑 강의</a></li>
          </ul>
        </article>

        <!-- Card: Quick Tasks -->
        <article class="rounded-2xl shadow-sm border border-slate-200/60 dark:border-slate-800 bg-[var(--card-bg)] backdrop-blur-md p-5">
          <header class="mb-3"><h2 class="font-semibold">퀵 액션</h2></header>
          <div class="grid gap-2">
            <button class="btn" onclick="exportData()">백업 내보내기 (.json)</button>
            <label class="btn cursor-pointer">
              <input id="importFile" type="file" accept="application/json" class="hidden" />
              백업 불러오기 (.json)
            </label>
            <button class="btn" onclick="resetData()">모든 데이터 초기화</button>
          </div>
          <p class="mt-3 text-xs text-slate-500">링크/노트는 브라우저 <b>로컬스토리지</b>에 저장됩니다. 다른 기기에서 쓰려면 백업/복원을 사용하세요.</p>
        </article>
      </div>

      <!-- Notes mini -->
      <article class="rounded-2xl shadow-sm border border-slate-200/60 dark:border-slate-800 bg-[var(--card-bg)] backdrop-blur-md p-5">
        <header class="flex items-center justify-between mb-3"><h2 class="font-semibold">오늘의 메모</h2><button class="text-xs underline" onclick="gotoTab('notes')">전체 메모로 이동</button></header>
        <textarea id="quickMemo" class="w-full h-28 rounded-lg border border-slate-300/70 dark:border-slate-700 bg-white/70 dark:bg-slate-900/60 p-3" placeholder="간단한 학습 기록을 남겨보세요"></textarea>
        <div class="mt-2 text-right"><button class="btn" onclick="saveQuickMemo()">저장</button></div>
      </article>
    </section>

    <!-- Schedule Tab -->
    <section id="tab-schedule" class="tab-pane hidden">
      <div class="grid lg:grid-cols-3 gap-6">
        <article class="lg:col-span-2 rounded-2xl shadow-sm border border-slate-200/60 dark:border-slate-800 bg-[var(--card-bg)] backdrop-blur-md p-5">
          <header class="mb-3"><h2 class="font-semibold">바둑 일정 (Google Calendar 임베드)</h2></header>
          <!-- Google Calendar: 아래 src 의 YOUR_CALENDAR_ID 를 본인 캘린더 ID 로 교체하세요 -->
          <div class="aspect-[4/3] rounded-xl overflow-hidden border border-slate-200/60 dark:border-slate-800">
            <iframe title="Google Calendar"
              src="https://calendar.google.com/calendar/embed?src=YOUR_CALENDAR_ID&ctz=Asia%2FSeoul"
              class="w-full h-full" loading="lazy"></iframe>
          </div>
          <p class="mt-3 text-xs text-slate-500">Google 캘린더에서 <b>설정 → 캘린더 통합 → 공개</b> 후 <b>캘린더 ID</b>를 사용하세요. 비공개로 두면 보이지 않습니다.</p>
        </article>
        <article class="rounded-2xl shadow-sm border border-slate-200/60 dark:border-slate-800 bg-[var(--card-bg)] backdrop-blur-md p-5">
          <header class="mb-3"><h2 class="font-semibold">개인 일정(수동)</h2></header>
          <ul id="eventsList" class="grid gap-2"></ul>
          <div class="mt-3 grid gap-2">
            <input id="eventTitle" class="input" placeholder="예: 목 20:00 온라인 대국" />
            <input id="eventDate" type="date" class="input" />
            <button class="btn" onclick="addEvent()">일정 추가</button>
          </div>
        </article>
      </div>
    </section>

    <!-- Notes Tab -->
    <section id="tab-notes" class="tab-pane hidden">
      <article class="rounded-2xl shadow-sm border border-slate-200/60 dark:border-slate-800 bg-[var(--card-bg)] backdrop-blur-md p-5">
        <header class="flex items-center justify-between mb-3">
          <h2 class="font-semibold">학습 노트</h2>
          <div class="flex gap-2">
            <button class="btn" onclick="exportNotes()">노트 내보내기</button>
            <label class="btn cursor-pointer"><input id="importNotesFile" type="file" accept="application/json" class="hidden"/>노트 불러오기</label>
          </div>
        </header>
        <div class="grid md:grid-cols-2 gap-6">
          <section>
            <h3 class="font-medium mb-2">오늘 배운 점</h3>
            <textarea id="noteToday" class="w-full h-40 input" placeholder="예: 귀 사활에서 1선 젖힘 후 끊기 수읽기..." ></textarea>
          </section>
          <section>
            <h3 class="font-medium mb-2">다음에 볼 것</h3>
            <textarea id="noteNext" class="w-full h-40 input" placeholder="예: 수상전 길게 끄는 형태, 치중 타이밍..." ></textarea>
          </section>
        </div>
        <div class="mt-3 text-right"><button class="btn" onclick="saveNotes()">노트 저장</button></div>
      </article>
    </section>

    <!-- About Tab -->
    <section id="tab-about" class="tab-pane hidden">
      <article class="rounded-2xl shadow-sm border border-slate-200/60 dark:border-slate-800 bg-[var(--card-bg)] backdrop-blur-md p-5">
        <h2 class="font-semibold mb-3">사이트 소개</h2>
        <p class="text-sm leading-7">이 페이지는 GitHub Pages 위에서 동작하는 <b>정적 웹사이트</b> 템플릿입니다. 바둑 공부 링크와 일정, 노트를 브라우저에 안전하게 저장하고, 필요할 때 <b>JSON 백업</b>으로 내보내거나 복원할 수 있습니다. 코드 한 파일만으로 관리되며, 서버 비용 없이 운용 가능합니다.</p>
        <ul class="list-disc ms-5 mt-3 text-sm space-y-1">
          <li>상단 <b>빠른 편집</b> 링크를 눌러 이 파일을 직접 수정하세요.</li>
          <li>Google 캘린더 임베드 사용 시, 자신의 캘린더 ID로 교체하세요.</li>
          <li>브라우저를 바꿀 때는 백업/복원을 사용하세요.</li>
        </ul>
      </article>
    </section>
  </main>

  <footer class="mx-auto max-w-6xl px-4 pb-10 text-sm text-slate-500 dark:text-slate-400">
    <div class="pt-6 border-t border-slate-200/60 dark:border-slate-800">
      © <span id="year"></span> Baduk Study Hub · GitHub Pages
    </div>
  </footer>

  <!-- Modals & Templates -->
  <dialog id="addLinkModal" class="rounded-2xl p-0 w-full max-w-md bg-[var(--card-bg)] backdrop-blur-md border border-slate-200/60 dark:border-slate-800">
    <form method="dialog">
      <header class="p-4 border-b border-slate-200/60 dark:border-slate-800 flex items-center justify-between">
        <h3 class="font-semibold">링크 추가</h3>
        <button class="text-slate-500" value="cancel">✕</button>
      </header>
      <div class="p-4 grid gap-3">
        <input id="newLinkTitle" class="input" placeholder="제목 (예: 101围棋网)" />
        <input id="newLinkUrl" class="input" placeholder="https://" />
        <input id="newLinkTag" class="input" placeholder="태그 (예: 사활, 손빨, 강의)" />
      </div>
      <footer class="p-4 flex justify-end gap-2 border-t border-slate-200/60 dark:border-slate-800">
        <button class="btn" value="cancel">취소</button>
        <button class="btn" id="confirmAddLink" value="default">추가</button>
      </footer>
    </form>
  </dialog>

  <template id="rowTemplate">
    <li class="row flex items-center justify-between gap-3">
      <a class="flex-1 truncate hover:underline" target="_blank" rel="noopener"></a>
      <span class="tag text-xs"></span>
      <button class="text-xs text-red-500 hover:underline remove">삭제</button>
    </li>
  </template>

  <!-- Scripts -->
  <script>
    // ---------- Utilities ----------
    const $ = (s, el=document) => el.querySelector(s);
    const $$ = (s, el=document) => [...el.querySelectorAll(s)];
    const store = {
      get: (k, v) => JSON.parse(localStorage.getItem(k) || JSON.stringify(v)),
      set: (k, v) => localStorage.setItem(k, JSON.stringify(v))
    };

    // ---------- Tabs ----------
    function gotoTab(name){
      $$('.tab-pane').forEach(p=>p.classList.toggle('hidden', p.id!==`tab-${name}`));
      $$('.tab-btn').forEach(b=>{
        const active = b.dataset.tab===name;
        b.classList.toggle('bg-slate-900', active);
        b.classList.toggle('text-white', active);
        b.classList.toggle('dark:bg-white', active);
        b.classList.toggle('dark:text-slate-900', active);
      });
      history.replaceState({}, '', `#${name}`);
    }

    // ---------- Links ----------
    const linksKey = 'baduk.links.v1';
    function renderLinks(){
      const list = $('#linksList');
      list.innerHTML='';
      const links = store.get(linksKey, defaultLinks());
      $('#linksCount').textContent = `${links.length}개`;
      const tpl = $('#rowTemplate');
      links.forEach((it, idx)=>{
        const li = tpl.content.cloneNode(true);
        const a = $('a', li); a.textContent = it.title; a.href = it.url;
        const tag = $('.tag', li); tag.textContent = it.tag || '';
        $('.remove', li).addEventListener('click', ()=>removeLink(idx));
        list.appendChild(li);
      });
    }
    function defaultLinks(){
      return [
        { title:'101围棋网', url:'https://www.101weiqi.com/', tag:'사활' },
        { title:'Sensei\'s Library', url:'https://senseis.xmp.net/', tag:'사전' },
        { title:'OGS (Online-Go)', url:'https://online-go.com/', tag:'대국' },
        { title:'Baduk TV (YT 검색)', url:'https://www.youtube.com/results?search_query=%EB%B0%94%EB%91%91+%EA%B0%95%EC%9D%98', tag:'강의' }
      ];
    }
    function addLink(title, url, tag){
      const links = store.get(linksKey, defaultLinks());
      links.push({title, url, tag});
      store.set(linksKey, links); renderLinks();
    }
    function removeLink(idx){
      const links = store.get(linksKey, defaultLinks());
      links.splice(idx,1); store.set(linksKey, links); renderLinks();
    }

    // ---------- Events ----------
    const eventsKey = 'baduk.events.v1';
    function renderEvents(){
      const list = $('#eventsList');
      list.innerHTML='';
      const evts = store.get(eventsKey, []);
      if(!evts.length){
        list.innerHTML = '<li class="text-sm text-slate-500">일정을 추가해 보세요.</li>';
        return;
      }
      evts.sort((a,b)=>a.date.localeCompare(b.date));
      evts.forEach((e,i)=>{
        const li = document.createElement('li');
        li.className='row flex items-center justify-between gap-3';
        li.innerHTML = `<span class="truncate">${e.date} · ${escapeHtml(e.title)}</span><button class="text-xs text-red-500 hover:underline">삭제</button>`;
        $('button', li).addEventListener('click', ()=>{ evts.splice(i,1); store.set(eventsKey, evts); renderEvents(); });
        list.appendChild(li);
      });
    }
    function addEvent(){
      const title = $('#eventTitle').value.trim();
      const date = $('#eventDate').value;
      if(!title || !date) return alert('제목과 날짜를 입력하세요');
      const evts = store.get(eventsKey, []); evts.push({title, date});
      store.set(eventsKey, evts);
      $('#eventTitle').value=''; $('#eventDate').value='';
      renderEvents();
    }

    // ---------- Notes ----------
    const notesKey = 'baduk.notes.v1';
    function loadNotes(){
      const n = store.get(notesKey, { today:'', next:'' });
      $('#noteToday').value = n.today || '';
      $('#noteNext').value = n.next || '';
      $('#quickMemo').value = n.today || '';
    }
    function saveNotes(){
      store.set(notesKey, { today: $('#noteToday').value, next: $('#noteNext').value });
      alert('저장되었습니다');
    }
    function saveQuickMemo(){
      const n = store.get(notesKey, { today:'', next:'' });
      n.today = $('#quickMemo').value; store.set(notesKey, n); alert('저장되었습니다');
    }

    // ---------- Import / Export ----------
    function exportData(){
      const data = {
        links: store.get(linksKey, defaultLinks()),
        events: store.get(eventsKey, []),
        notes: store.get(notesKey, {today:'', next:''})
      };
      downloadJson(data, 'baduk-study-backup.json');
    }
    function exportNotes(){
      const data = store.get(notesKey, {today:'', next:''});
      downloadJson(data, 'baduk-notes.json');
    }
    function downloadJson(obj, filename){
      const blob = new Blob([JSON.stringify(obj, null, 2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href=url; a.download=filename; a.click();
      setTimeout(()=>URL.revokeObjectURL(url), 500);
    }
    $('#importFile').addEventListener('change', (e)=>{
      const f = e.target.files[0]; if(!f) return;
      const r = new FileReader(); r.onload = ()=>{
        try{
          const data = JSON.parse(r.result);
          if(data.links) store.set(linksKey, data.links);
          if(data.events) store.set(eventsKey, data.events);
          if(data.notes) store.set(notesKey, data.notes);
          renderLinks(); renderEvents(); loadNotes(); alert('복원이 완료되었습니다');
        }catch(err){ alert('파일 형식이 올바르지 않습니다'); }
      }; r.readAsText(f);
    });
    $('#importNotesFile').addEventListener('change', (e)=>{
      const f = e.target.files[0]; if(!f) return;
      const r = new FileReader(); r.onload = ()=>{
        try{ store.set(notesKey, JSON.parse(r.result)); loadNotes(); alert('노트를 불러왔습니다'); }
        catch{ alert('파일 형식이 올바르지 않습니다'); }
      }; r.readAsText(f);
    });

    // ---------- Edit / Add Link ----------
    $('#editBtn').addEventListener('click', (e)=>{
      e.preventDefault();
      alert('이 파일을 GitHub에서 직접 편집하세요:\n\n· 캘린더 src 의 YOUR_CALENDAR_ID 교체\n· 기본 링크 수정\n· 제목/설명 변경');
    });
    const addDialog = $('#addLinkModal');
    $('#addLinkBtn').addEventListener('click', ()=> addDialog.showModal());
    $('#confirmAddLink').addEventListener('click', (ev)=>{
      ev.preventDefault();
      const t = $('#newLinkTitle').value.trim();
      const u = $('#newLinkUrl').value.trim();
      const g = $('#newLinkTag').value.trim();
      if(!t || !u) return alert('제목과 URL을 입력하세요');
      addLink(t,u,g); addDialog.close(); $('#newLinkTitle').value=''; $('#newLinkUrl').value=''; $('#newLinkTag').value='';
    });

    // ---------- Helpers ----------
    function escapeHtml(s){ return s.replace(/[&<>"]+/g, c=>({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;"}[c])); }

    // ---------- Init ----------
    (function init(){
      const hash = location.hash.replace('#','');
      gotoTab(hash || 'links');
      renderLinks(); renderEvents(); loadNotes();
      $('#year').textContent = new Date().getFullYear();
    })();
  </script>

  <!-- Small UI helpers -->
  <style>
    .row{ @apply p-2 rounded-lg border border-slate-200/60 dark:border-slate-800 bg-white/70 dark:bg-slate-900/60 hover:bg-white dark:hover:bg-slate-900 transition; }
    .btn{ @apply px-3 py-1.5 rounded-lg text-sm font-medium border border-slate-300/70 dark:border-slate-700 bg-white/70 dark:bg-slate-900/60 hover:bg-slate-100 dark:hover:bg-slate-800; }
    .input{ @apply w-full rounded-lg border border-slate-300/70 dark:border-slate-700 bg-white/70 dark:bg-slate-900/60 p-2.5; }
  </style>
</body>
</html>
